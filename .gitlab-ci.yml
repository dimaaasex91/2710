variables:
  DOCKER_HOST: tcp://docker:2375/
  DOCKER_DRIVER: overlay2

image: 
  name: docker/compose:latest

services:
  - docker:dind

before_script:
  - docker version
  - docker-compose version

stages:
  # - "test"
  - "build"

# test:
#   stage: test
#   tags:
#     - "docker"
#   script:
#     - pytest --junitxml=report.xml
#   artifacts:
#     when: always
#     reports:
#       junit: report.xml

build:
  stage: build
  tags:
    - "docker"
  script:
    - docker-compose down
    - docker-compose build
    - docker-compose up -d
  only:
    - main
    - check_buckets
  
  